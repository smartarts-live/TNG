<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>brain-TRAINer!</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%232C3E50'/><text x='50%' y='50%' font-family='Arial, sans-serif' font-size='50' font-weight='bold' fill='%23FFFFFF' dominant-baseline='central' text-anchor='middle'>CP</text></svg>">

    <style>
        :root {
            --primary: #2C3E50;
            --accent: #E74C3C;
            --bg: #F8F9FA;
            --box: #FFFFFF;
            --text: #333333;
            --success: #27AE60;
            --warmup: #2980B9;
            --recovery: #16A085;
            --ppa: #8E44AD;
            --marathon: #D35400;
            --enpal: #00B0F0; /* NEU: Enpal Blau */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            user-select: none;
            position: relative;
        }

        .profile-signature {
            position: fixed; top: 20px; right: 20px; width: 50px; height: 50px;
            border-radius: 50%; border: 3px solid var(--box);
            box-shadow: 0 4px 10px rgba(0,0,0,0.15); object-fit: cover;
            z-index: 1000; transition: transform 0.2s;
        }
        .profile-signature:hover { transform: scale(1.1); }

        .container {
            background-color: var(--box); width: 100%; max-width: 1000px;
            padding: 40px; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center; position: relative;
        }

        h1 { color: var(--primary); margin-top: 0; }
        h2 { color: var(--primary); }
        p.instruction { font-size: 1.1rem; color: #666; margin-bottom: 30px; line-height: 1.5; }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px; margin-top: 30px;
        }
        
        .dash-card {
            background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px;
            padding: 25px; transition: transform 0.2s, box-shadow 0.2s; cursor: pointer;
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .dash-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
        .dash-card h3 { margin: 0 0 10px 0; font-size: 1.4rem; }
        .dash-card p { margin: 0 0 20px 0; color: #666; font-size: 0.95rem; line-height: 1.4; flex-grow: 1; }
        .dash-btn { padding: 12px; font-weight: bold; border: none; border-radius: 6px; color: white; cursor: pointer; width: 100%; }

        /* NEUE KLASSEN F√úR ENPAL */
        .card-enpal { border-color: var(--enpal); }
        .card-enpal h3 { color: var(--enpal); }
        .card-enpal .dash-btn { background: var(--enpal); }

        .card-wu { border-color: var(--warmup); }
        .card-wu h3 { color: var(--warmup); }
        .card-wu .dash-btn { background: var(--warmup); }

        .card-rec { border-color: var(--recovery); }
        .card-rec h3 { color: var(--recovery); }
        .card-rec .dash-btn { background: var(--recovery); }

        .card-ppa { border-color: var(--ppa); }
        .card-ppa h3 { color: var(--ppa); }
        .card-ppa .dash-btn { background: var(--ppa); }

        .card-sprint { border-color: var(--primary); }
        .card-sprint h3 { color: var(--primary); }
        .card-sprint .dash-btn { background: var(--primary); }

        .card-marathon { border-color: var(--marathon); }
        .card-marathon h3 { color: var(--marathon); }
        .card-marathon .dash-btn { background: var(--marathon); }

        .hardcore-label { display: block; margin-bottom: 15px; font-size: 0.95rem; color: var(--accent); font-weight: bold; cursor: pointer; }
        .hardcore-label input { margin-right: 8px; transform: scale(1.2); cursor: pointer; }

        button.control-btn { background-color: var(--primary); color: white; font-size: 1.2rem; padding: 15px 40px; border: none; border-radius: 6px; margin-top: 20px; cursor: pointer; font-weight: bold; }
        button.control-btn:hover { background-color: #1a252f; }
        button.option-btn { background-color: var(--box); border: 2px solid var(--primary); color: var(--primary); padding: 20px; font-size: 1.3rem; border-radius: 6px; cursor: pointer; font-weight: bold; transition: all 0.2s;}
        button.option-btn:hover { background-color: var(--primary); color: var(--box); }

        .status-bar { display: flex; justify-content: space-between; font-weight: bold; color: #7f8c8d; margin-bottom: 15px; font-size: 1.2rem; background: #ecf0f1; padding: 10px 20px; border-radius: 6px; }
        .timer-container { width: 100%; height: 12px; background-color: #eee; border-radius: 6px; margin-bottom: 30px; overflow: hidden; display: none; }
        .timer-bar { height: 100%; width: 100%; background-color: var(--accent); transition: width 0.1s linear, background-color 0.3s; }
        
        #question-area, #result-area, #ppa-area, #ppa-result-area { display: none; }
        
        .question-text { font-size: 1.5rem; font-weight: 600; margin-bottom: 20px; color: var(--primary); min-height: 60px; }
        .data-display { font-size: 2.2rem; letter-spacing: 4px; margin-bottom: 30px; padding: 20px; background: #f0f4f8; border-radius: 8px; font-family: monospace; min-height: 40px; word-wrap: break-word; }
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        .ppa-block { background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px; text-align: left; border: 1px solid #ddd; }
        .ppa-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .ppa-row:last-child { border-bottom: none; }
        .ppa-word { font-size: 1.2rem; font-weight: 600; width: 40%; }
        .ppa-controls { display: flex; gap: 20px; }
        .ppa-radio-group { display: flex; flex-direction: column; align-items: center; font-size: 0.8rem; color: #666; }
        input[type="radio"] { transform: scale(1.5); margin-top: 5px; cursor: pointer; }

        .analytics-table { width: 100%; border-collapse: collapse; margin-top: 30px; font-size: 1rem; }
        .analytics-table th, .analytics-table td { border: 1px solid #ddd; padding: 12px; text-align: center; }
        .analytics-table th { background-color: var(--primary); color: white; }
        .analytics-table tr:nth-child(even) { background-color: #f2f2f2; }
        .weakness { background-color: #fadbd8 !important; }
        .strength { background-color: #d5f5e3 !important; }
        .score-circle { width: 120px; height: 120px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; font-weight: bold; margin: 0 auto 20px auto; }
        
    </style>
</head>
<body>

    <img src="painted.jpg" alt="Constantin Paul" class="profile-signature" onerror="this.style.display='none'">

    <div class="container">
        
        <div id="start-screen">
            <h1>brain-TRAINer!</h1>
            <p class="instruction">
                W√§hle dein Trainingsmodul. Bereite dich systematisch auf das Verhaltenprofil (PPA) und die kognitiven Leistungstests (GIA) vor.
            </p>
            
            <div class="dashboard-grid">
                
                <div class="dash-card card-enpal" onclick="window.location.href='enpal.html'">
                    <div>
                        <h3>‚òÄÔ∏è Enpal Spickzettel</h3>
                        <p>Dein digitaler Leitfaden f√ºr das Interview. Argumente f√ºr B2B (Handwerk) und B2C (Privatkunden).</p>
                    </div>
                    <button class="dash-btn">SPICKZETTEL √ñFFNEN</button>
                </div>

                <div class="dash-card card-wu" onclick="window.location.href='warm-up.html'">
                    <div>
                        <h3>üß† Brain Warm-Up</h3>
                        <p>5 Min. Aktivierung. Bricht tiefe Lesemuster und weckt die visuelle Geschwindigkeit.</p>
                    </div>
                    <button class="dash-btn">WARM-UP STARTEN</button>
                </div>

                <div class="dash-card card-ppa" onclick="startPPA()">
                    <div>
                        <h3>üë§ PPA-Profiling</h3>
                        <p>Verhaltens-Assessment (DISG). Trainiere die Forced-Choice Mechanik.</p>
                    </div>
                    <button class="dash-btn">PROFILING STARTEN</button>
                </div>
                
                <div class="dash-card" style="border-color: #E67E22;" onclick="window.location.href='eisenhower.html'">
                    <div>
                        <h3 style="color: #E67E22;">üì• Postkorb-√úbung</h3>
                        <p>Eisenhower-Matrix. Priorisiere 10 realistische Klinik/Hotel-Szenarien unter Zeitdruck.</p>
                    </div>
                    <button class="dash-btn" style="background: #E67E22;">POSTKORB STARTEN</button>
                </div>

                <div class="dash-card card-sprint">
                    <div>
                        <h3>‚ö° GIA Pro-Sprint</h3>
                        <p>30 Aufgaben, 16 Typen. Mit Schwachstellen-Radar und optionalem Zeit-Stress.</p>
                    </div>
                    <div>
                        <label class="hardcore-label">
                            <input type="checkbox" id="hardcore-toggle"> üî• Hardcore-Modus
                        </label>
                        <button class="dash-btn" onclick="startTest('sprint')">SPRINT STARTEN</button>
                    </div>
                </div>
                
                <div class="dash-card card-marathon" onclick="startTest('marathon')">
                    <div>
                        <h3>üî• GIA Marathon</h3>
                        <p>15 Minuten Ausdauer. Simuliert die echte kognitive Ersch√∂pfung.</p>
                    </div>
                    <button class="dash-btn">MARATHON STARTEN</button>
                </div>

                <div class="dash-card card-rec" onclick="window.location.href='recovery.html'">
                    <div>
                        <h3>üåø Neuro-Recovery</h3>
                        <p>4 Min. Cool-Down. Augen entspannen und Cortisol senken nach dem Sprint.</p>
                    </div>
                    <button class="dash-btn">RECOVERY STARTEN</button>
                </div>

                <div class="dash-card" style="border-color: #1ABC9C;" onclick="window.location.href='body-soul.html'">
                    <div>
                        <h3 style="color: #1ABC9C;">üßò Body & Soul</h3>
                        <p>Biohacking. Audio-Synthesizer (Brown Noise) f√ºr tiefen Fokus & gef√ºhrtes Desk-Stretching.</p>
                    </div>
                    <button class="dash-btn" style="background: #1ABC9C;">SESSION STARTEN</button>
                </div>

                <div class="dash-card" style="border-color: #F39C12;" onclick="window.location.href='games.html'">
                    <div>
                        <h3 style="color: #F39C12;">üéÆ Fun-Break</h3>
                        <p>Dopamin-Reset. Ein zuf√§lliges Retro-Spiel. Nach dem "Game Over" geht das Training sofort weiter!</p>
                    </div>
                    <button class="dash-btn" style="background: #F39C12;">SPIEL STARTEN</button>
                </div>

            </div>
        </div>

        <div id="ppa-area">
            <h2 style="color: var(--ppa);">Thomas PPA Profiling</h2>
            <div class="status-bar">
                <span id="ppa-counter">Block: 1 / 10</span>
                <span>Forced-Choice</span>
            </div>
            <p style="text-align:left; color:#555;">W√§hle in jedem Block exakt <strong>EIN</strong> Adjektiv, das am MEISTEN auf dich zutrifft (+), und <strong>EIN</strong> Adjektiv, das am WENIGSTEN auf dich zutrifft (-).</p>
            
            <div id="ppa-container"></div>
            <button class="control-btn" style="background: var(--ppa);" onclick="nextPPABlock()">N√ÑCHSTER BLOCK</button>
            <p id="ppa-error" style="color:var(--accent); display:none; font-weight:bold; margin-top:15px;">Bitte w√§hle genau ein [+] und ein [-]!</p>
        </div>

        <div id="ppa-result-area">
            <h2 style="color: var(--ppa);">Dein Verhaltensprofil</h2>
            <div class="score-circle" id="ppa-score-circle" style="background: var(--ppa);">DISG</div>
            <div id="ppa-analysis" style="text-align:left; font-size:1.1rem; line-height:1.6; margin-bottom:30px;"></div>
            <button class="control-btn" onclick="location.reload()">ZUM DASHBOARD</button>
        </div>

        <div id="question-area">
            <div class="status-bar">
                <span id="round-counter">Frage: 1</span>
                <span id="global-timer" style="display:none; color:var(--marathon);">15:00</span>
                <span id="timer-text">15.0s</span>
            </div>
            <div class="timer-container" id="timer-container"><div class="timer-bar" id="timer-bar"></div></div>
            <div class="question-text" id="question-text">L√§dt...</div>
            <div class="data-display" id="data-display" style="display: none;"></div>
            <div class="options-grid" id="options-grid"></div>
        </div>

        <div id="result-area">
            <h1 id="result-title">Test Abgeschlossen</h1>
            <div class="score-circle" id="score-display">0%</div>
            <div id="stats-display" style="font-size: 1.2rem; margin-bottom: 20px;"></div>
            
            <h2>Schwachstellen-Radar</h2>
            <table class="analytics-table" id="analytics-table">
                <thead><tr><th>Aufgabentyp</th><th>Anzahl</th><th>Genauigkeit</th><th>√ò Zeit</th></tr></thead>
                <tbody id="analytics-body"></tbody>
            </table>
            <button class="control-btn" onclick="location.reload()">ZUM DASHBOARD</button>
        </div>

    </div>

    <script>
        function showScreen(id) {
            ['start-screen', 'ppa-area', 'ppa-result-area', 'question-area', 'result-area'].forEach(el => {
                document.getElementById(el).style.display = (el === id) ? 'block' : 'none';
            });
        }

        /* =========================================================
           PPA LOGIK (DISG)
           ========================================================= */
        const ppaBlocks = [
            [ {w:"Durchsetzungsstark", t:"D"}, {w:"Redegewandt", t:"I"}, {w:"Geduldig", t:"S"}, {w:"Genau", t:"G"} ],
            [ {w:"Risikobereit", t:"D"}, {w:"Begeisternd", t:"I"}, {w:"Teamf√§hig", t:"S"}, {w:"Vorsichtig", t:"G"} ],
            [ {w:"Bestimmt", t:"D"}, {w:"Kontaktfreudig", t:"I"}, {w:"Best√§ndig", t:"S"}, {w:"Perfektionistisch", t:"G"} ],
            [ {w:"Wetteifernd", t:"D"}, {w:"√úberzeugend", t:"I"}, {w:"Entspannt", t:"S"}, {w:"Logisch", t:"G"} ],
            [ {w:"K√ºhn", t:"D"}, {w:"Charmant", t:"I"}, {w:"Loyal", t:"S"}, {w:"Systematisch", t:"G"} ],
            [ {w:"Unabh√§ngig", t:"D"}, {w:"Gesellig", t:"I"}, {w:"Ausgeglichen", t:"S"}, {w:"Detailliert", t:"G"} ],
            [ {w:"Entschlossen", t:"D"}, {w:"Optimistisch", t:"I"}, {w:"Hilfsbereit", t:"S"}, {w:"Sorgf√§ltig", t:"G"} ],
            [ {w:"Direkt", t:"D"}, {w:"Lebhaft", t:"I"}, {w:"Freundlich", t:"S"}, {w:"Analytisch", t:"G"} ],
            [ {w:"Fordernd", t:"D"}, {w:"Inspirierend", t:"I"}, {w:"Zuh√∂rend", t:"S"}, {w:"Strukturiert", t:"G"} ],
            [ {w:"Willensstark", t:"D"}, {w:"Ausdrucksvoll", t:"I"}, {w:"Zuverl√§ssig", t:"S"}, {w:"Kritisch", t:"G"} ]
        ];

        let currentPpaBlock = 0; let ppaScores = { D: 0, I: 0, S: 0, G: 0 };

        function startPPA() {
            ppaScores = { D: 0, I: 0, S: 0, G: 0 }; currentPpaBlock = 0; showScreen('ppa-area'); renderPPABlock();
        }

        function renderPPABlock() {
            document.getElementById('ppa-counter').innerText = `Block: ${currentPpaBlock + 1} / 10`;
            document.getElementById('ppa-error').style.display = 'none';
            const container = document.getElementById('ppa-container'); container.innerHTML = '';
            const block = ppaBlocks[currentPpaBlock];
            const div = document.createElement('div'); div.className = 'ppa-block';
            
            block.forEach((item, idx) => {
                div.innerHTML += `<div class="ppa-row"><div class="ppa-word">${item.w}</div><div class="ppa-controls"><label class="ppa-radio-group">MEISTEN (+)<input type="radio" name="most" value="${item.t}"></label><label class="ppa-radio-group">WENIGSTEN (-)<input type="radio" name="least" value="${item.t}"></label></div></div>`;
            });
            container.appendChild(div);

            const radios = document.querySelectorAll('input[type="radio"]');
            radios.forEach(radio => {
                radio.addEventListener('change', function() {
                    const type = this.value; const isMost = this.name === 'most';
                    const correspondingOther = document.querySelector(`input[name="${isMost ? 'least' : 'most'}"][value="${type}"]`);
                    if(correspondingOther && correspondingOther.checked) correspondingOther.checked = false;
                });
            });
        }

        function nextPPABlock() {
            const most = document.querySelector('input[name="most"]:checked');
            const least = document.querySelector('input[name="least"]:checked');
            if(!most || !least) { document.getElementById('ppa-error').style.display = 'block'; return; }
            ppaScores[most.value] += 1; ppaScores[least.value] -= 1;
            currentPpaBlock++;
            if(currentPpaBlock >= ppaBlocks.length) { endPPA(); } else { renderPPABlock(); }
        }

        function endPPA() {
            showScreen('ppa-result-area');
            let analysis = `<strong>Deine Auswertung (Werte zwischen -10 und +10):</strong><br>Dominanz (D): ${ppaScores.D} <br>Initiative (I): ${ppaScores.I} <br>Stetigkeit (S): ${ppaScores.S} <br>Gewissenhaftigkeit (G): ${ppaScores.G} <br><br><strong>Operations Manager Fit (Klinik & Hotellerie):</strong><br>`;
            if (ppaScores.D > 0 && ppaScores.G > 0) analysis += `<span style="color:var(--success)">Exzellenter Fit.</span> Du zeigst Entscheidungsfreude (D) kombiniert mit Prozessgenauigkeit (G). Das ist das ideale Profil, um Strukturen umzusetzen und Teams zu f√ºhren.`;
            else if (ppaScores.S > 5 || ppaScores.I > 5) analysis += `<span style="color:var(--marathon)">Hoher Empathie-Fokus.</span> Dein Fokus liegt stark auf Harmonie (S) und Kommunikation (I). Im Operations-Bereich wird oft etwas mehr operative H√§rte (D) oder strukturierte Pr√§zision (G) gesucht. Achte darauf, in Interviews deine Durchsetzungsst√§rke zu betonen.`;
            else analysis += `Ausgeglichenes Profil. Du kannst dich gut an verschiedene Situationen anpassen.`;
            document.getElementById('ppa-analysis').innerHTML = analysis;
        }

        /* =========================================================
           GIA TEST LOGIK (SPRINT 30 & MARATHON)
           ========================================================= */
        const typeNames = [ "Wortbedeutung", "Wahrnehmungsgeschw.", "Zahlengeschwindigkeit", "Logisches Denken", "Spiegeln (1 Achse)", "Symbol-Codierung", "Detail-Scanning", "Rotation (180¬∞)", "Alphabet-Verschiebung", "Vokal-Scanning", "Semantische Gr√∂√üen", "Tages-Logik", "Sequenzielle Mathematik", "Richtungs-Logik", "Daten-Abgleich", "Kategorien-Ausschluss" ];
        let mode = 'sprint'; let currentRound = 1; let testTimerInterval;
        let timeLimit = 15; let timeLeft = timeLimit; let isHardcore = false;
        let globalTimeLeft = 900; let globalTimerInterval;
        let questionStartTime; let currentAnswer = ""; let lastType = -1; let analytics = {};

        const wordGroups = [ { syns: ["Steuern", "Lenken", "Leiten", "F√ºhren"], ants: ["Folgen", "Gehorchen"] }, { syns: ["Effizient", "Rationell", "Wirtschaftlich", "Produktiv"], ants: ["Umst√§ndlich", "Ineffizient"] }, { syns: ["Verbessern", "Optimieren", "Perfektionieren"], ants: ["Verschlechtern", "Mindern"] }, { syns: ["Zunehmen", "Steigern", "Expandieren", "Wachsen"], ants: ["Schrumpfen", "Sinken"] } ];
        const semanticGroups = [ { items: ["Tropfen", "Pf√ºtze", "Teich", "See", "Meer", "Ozean"], desc: "GR√ñSSTEN" }, { items: ["Millimeter", "Zentimeter", "Meter", "Kilometer", "Meile"], desc: "L√ÑNGSTEN" }, { items: ["Sekunde", "Minute", "Stunde", "Tag", "Woche", "Jahr"], desc: "K√úRZESTEN" } ];
        const days = ["Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag", "Sonntag"];

        function startTest(selectedMode) {
            mode = selectedMode;
            isHardcore = document.getElementById('hardcore-toggle') && document.getElementById('hardcore-toggle').checked;
            timeLimit = 15; // Reset auf 15s Startwert
            showScreen('question-area');
            document.getElementById('timer-container').style.display = 'block';
            
            analytics = {}; for(let i=0; i<16; i++) { analytics[i] = { attempts: 0, correct: 0, time: 0 }; }
            currentRound = 1; lastType = -1;
            
            if(mode === 'marathon') {
                globalTimeLeft = 900; document.getElementById('global-timer').style.display = 'inline';
                clearInterval(globalTimerInterval); globalTimerInterval = setInterval(updateGlobalTimer, 1000);
            } else { document.getElementById('global-timer').style.display = 'none'; }
            generateQuestion();
        }

        function updateGlobalTimer() {
            globalTimeLeft--; let m = Math.floor(globalTimeLeft / 60); let s = globalTimeLeft % 60;
            document.getElementById('global-timer').innerText = `Verbleibend: ${m}:${s < 10 ? '0'+s : s}`;
            if(globalTimeLeft <= 0) endTest();
        }

        function generateQuestion() {
            if (mode === 'sprint' && currentRound > 30) { endTest(); return; }
            let type = Math.floor(Math.random() * 16); while(type === lastType) type = Math.floor(Math.random() * 16); lastType = type;
            let qText = "", dataText = "", options = [];

            switch(type) {
                case 0:
                    const group = wordGroups[Math.floor(Math.random() * wordGroups.length)];
                    const shuffledSyns = group.syns.sort(() => 0.5 - Math.random()).slice(0, 3);
                    const ant = group.ants[Math.floor(Math.random() * group.ants.length)];
                    options = [...shuffledSyns, ant].sort(() => 0.5 - Math.random());
                    qText = "Welches Wort passt in seiner Bedeutung NICHT zu den anderen?"; currentAnswer = ant; break;
                case 1:
                    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"; let str = ""; for(let i=0; i<8; i++) str += chars.charAt(Math.floor(Math.random() * chars.length));
                    let str2 = str; const isIdentical = Math.random() > 0.5;
                    if (!isIdentical) {
                        const changeIdx = Math.floor(Math.random() * str.length); let newChar = chars.charAt(Math.floor(Math.random() * chars.length));
                        while(newChar === str[changeIdx]) newChar = chars.charAt(Math.floor(Math.random() * chars.length));
                        str2 = str.substring(0, changeIdx) + newChar + str.substring(changeIdx + 1);
                    }
                    qText = "Sind diese beiden Zeichenketten exakt IDENTISCH?"; dataText = `${str}  |  ${str2}`;
                    options = ["JA", "NEIN"]; currentAnswer = isIdentical ? "JA" : "NEIN"; break;
                case 2:
                    let nums = Array.from({length: 5}, () => Math.floor(Math.random() * 40) + 10);
                    const max = Math.max(...nums); const min = Math.min(...nums); const isAdd = Math.random() > 0.5;
                    qText = isAdd ? "Gr√∂√üte und kleinste Zahl ADDIEREN:" : "Kleinste von der gr√∂√üten Zahl SUBTRAHIEREN:"; dataText = nums.join(" - ");
                    const correctMath = isAdd ? (max + min) : (max - min); options = [correctMath, correctMath+2, correctMath-3, correctMath+10].map(String).sort(() => 0.5 - Math.random());
                    currentAnswer = String(correctMath); break;
                case 3:
                    const names = ["Anna", "Bernd", "Chris", "Dirk", "Eva"]; const p = names.sort(() => 0.5 - Math.random()).slice(0, 3);
                    qText = `${p[0]} ist √§lter als ${p[1]}. ${p[1]} ist j√ºnger als ${p[2]}. Wer ist am j√ºngsten?`;
                    options = [p[0], p[1], p[2], "Nicht ableitbar"].sort(() => 0.5 - Math.random()); currentAnswer = p[1]; break;
                case 4:
                    const bases = ["b", "d", "p", "q"]; const base = bases[Math.floor(Math.random() * bases.length)]; const isHori = Math.random() > 0.5;
                    qText = `Stell dir '${base}' vor. Spiegele es ${isHori ? 'HORIZONTAL' : 'VERTIKAL'}. Was entsteht?`; let res = "";
                    if(base === "b") res = isHori ? "d" : "p"; if(base === "d") res = isHori ? "b" : "q"; if(base === "p") res = isHori ? "q" : "b"; if(base === "q") res = isHori ? "p" : "d";
                    options = ["b", "d", "p", "q"].sort(() => 0.5 - Math.random()); currentAnswer = res; break;
                case 5:
                    const symbols = ['‚òÖ', '‚ô†', '‚ô£', '‚ô¶', '‚ô•']; const pickedSyms = symbols.sort(() => 0.5 - Math.random()).slice(0, 3);
                    const vals = [Math.floor(Math.random()*9)+1, Math.floor(Math.random()*9)+1, Math.floor(Math.random()*9)+1];
                    dataText = `${pickedSyms[0]}=${vals[0]}  ${pickedSyms[1]}=${vals[1]}  ${pickedSyms[2]}=${vals[2]}`;
                    const qSeq = [pickedSyms[2], pickedSyms[0], pickedSyms[1]]; qText = `Entschl√ºssele: ${qSeq.join('')}`;
                    const correctCode = `${vals[2]}${vals[0]}${vals[1]}`; options = [correctCode, `${vals[0]}${vals[1]}${vals[2]}`, `${vals[2]}${vals[1]}${vals[0]}`, `${vals[1]}${vals[0]}${vals[2]}`];
                    options = [...new Set(options)]; while(options.length < 4) options.push(String(Math.floor(Math.random()*900)+100));
                    options.sort(() => 0.5 - Math.random()); currentAnswer = correctCode; break;
                case 6:
                    const targetDigit = Math.floor(Math.random() * 9) + 1; const amount = Math.floor(Math.random() * 3) + 3; let digitString = "";
                    for(let i=0; i<15; i++) { let rand = Math.floor(Math.random() * 9) + 1; if(rand === targetDigit) rand = (rand % 9) + 1; digitString += rand; }
                    let arr = digitString.split(''); for(let i=0; i<amount; i++) arr[Math.floor(Math.random() * arr.length)] = targetDigit; digitString = arr.join('');
                    qText = `Wie oft taucht '${targetDigit}' in dieser Reihe auf?`; dataText = digitString;
                    options = [amount, amount-1, amount+1, amount+2].map(String).sort(() => 0.5 - Math.random()); currentAnswer = String(amount); break;
                case 7:
                    const rotBases = ["b", "d", "p", "q"]; const rotBase = rotBases[Math.floor(Math.random() * rotBases.length)];
                    qText = `Stell dir '${rotBase}' vor. Drehe es um exakt 180 GRAD. Was entsteht?`; let rotRes = "";
                    if(rotBase === "b") rotRes = "q"; if(rotBase === "d") rotRes = "p"; if(rotBase === "p") rotRes = "d"; if(rotBase === "q") rotRes = "b";
                    options = ["b", "d", "p", "q"].sort(() => 0.5 - Math.random()); currentAnswer = rotRes; break;
                case 8:
                    const abc = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; const shift = Math.floor(Math.random() * 3) + 2; const isForward = Math.random() > 0.5; const startIndex = Math.floor(Math.random() * 16) + 5;
                    const startLetter = abc[startIndex]; qText = `Welcher Buchstabe kommt im Alphabet exakt ${shift} Stellen ${isForward ? 'NACH' : 'VOR'} dem '${startLetter}'?`;
                    const correctIndex = isForward ? startIndex + shift : startIndex - shift; const correctLetter = abc[correctIndex];
                    options = [correctLetter, abc[correctIndex+1], abc[correctIndex-1], abc[correctIndex+2]].sort(() => 0.5 - Math.random()); currentAnswer = correctLetter; break;
                case 9:
                    const consonants = "BCDFGHJKLMNPQRSTVWXYZ"; const vowels = "AEIOU"; const vowelCount = Math.floor(Math.random() * 3) + 3; let charArr = [];
                    for(let i=0; i<vowelCount; i++) charArr.push(vowels[Math.floor(Math.random()*vowels.length)]); for(let i=0; i<(12-vowelCount); i++) charArr.push(consonants[Math.floor(Math.random()*consonants.length)]);
                    charArr = charArr.sort(() => 0.5 - Math.random()); dataText = charArr.join(" "); qText = `Wie viele Vokale (A,E,I,O,U) sind hier versteckt?`;
                    options = [vowelCount, vowelCount-1, vowelCount+1, vowelCount+2].map(String).sort(() => 0.5 - Math.random()); currentAnswer = String(vowelCount); break;
                case 10:
                    const semGroup = semanticGroups[Math.floor(Math.random() * semanticGroups.length)]; const isMin = Math.random() > 0.5;
                    let indices = []; while(indices.length < 4) { let r = Math.floor(Math.random() * semGroup.items.length); if(indices.indexOf(r) === -1) indices.push(r); } indices.sort((a,b) => a - b);
                    const askedDesc = isMin ? (semGroup.desc === "GR√ñSSTEN" ? "KLEINSTEN" : (semGroup.desc === "L√ÑNGSTEN" ? "K√úRZESTEN" : "L√ÑNGSTEN")) : semGroup.desc;
                    qText = `Welcher Begriff ist in der realen Welt am ${askedDesc}?`; options = indices.map(i => semGroup.items[i]).sort(() => 0.5 - Math.random());
                    currentAnswer = isMin ? semGroup.items[indices[0]] : semGroup.items[indices[3]]; break;
                case 11:
                    const baseDayIdx = Math.floor(Math.random() * 7); const offsets = [{name: "Vorgestern", val: -2}, {name: "Gestern", val: -1}, {name: "Morgen", val: 1}, {name: "√úbermorgen", val: 2}];
                    const cond = offsets[Math.floor(Math.random() * offsets.length)]; const ask = offsets[Math.floor(Math.random() * offsets.length)];
                    qText = `Wenn ${cond.name} ${days[baseDayIdx]} war, welcher Tag ist dann ${ask.name}?`;
                    let heuteIdx = (baseDayIdx - cond.val + 14) % 7; let askIdx = (heuteIdx + ask.val + 14) % 7; const correctDay = days[askIdx];
                    options = [correctDay, days[(askIdx+1)%7], days[(askIdx+2)%7], days[(askIdx-1+7)%7]].sort(() => 0.5 - Math.random()); currentAnswer = correctDay; break;
                case 12: 
                    const startNum = Math.floor(Math.random() * 10) + 2; const op1 = Math.floor(Math.random() * 5) + 2; const op2 = Math.floor(Math.random() * 3) + 2;
                    qText = `Kopfrechnen: Starte mit ${startNum}. Addiere ${op1}. Multipliziere das Ergebnis mit ${op2}.`; const result12 = (startNum + op1) * op2;
                    options = [result12, result12 - op2, result12 + op2, result12 + startNum].map(String).sort(() => 0.5 - Math.random()); currentAnswer = String(result12); break;
                case 13: 
                    const pairs = [ ["NORDEN", "S√úDEN", "OSTEN"], ["S√úDEN", "NORDEN", "WESTEN"], ["OSTEN", "WESTEN", "NORDEN"], ["WESTEN", "OSTEN", "S√úDEN"] ]; const rPair = pairs[Math.floor(Math.random() * pairs.length)];
                    qText = `Gehe 2 Felder ${rPair[0]}. Dann 1 Feld ${rPair[2]}. Dann 2 Felder ${rPair[1]}. Wo bist du vom Start?`;
                    options = [`Exakt im ${rPair[2]}`, `Exakt im ${rPair[0]}`, `Exakt im ${rPair[1]}`, "Wieder am Start"].sort(() => 0.5 - Math.random()); currentAnswer = `Exakt im ${rPair[2]}`; break;
                case 14: 
                    const codes = ["AX7", "B9Q", "M4V", "P2L", "K8R", "Z3W"]; const pCodes = codes.sort(() => 0.5 - Math.random()).slice(0,3); const isError = Math.random() > 0.5; let pCodes2 = [...pCodes];
                    if(isError) pCodes2[1] = pCodes2[1].replace(/[A-Z]/, "C"); qText = "Stimmen Liste A und Liste B zu 100% √ºberein?"; dataText = `A: ${pCodes.join("-")} \nB: ${pCodes2.join("-")}`;
                    options = ["JA", "NEIN"]; currentAnswer = isError ? "NEIN" : "JA"; break;
                case 15: 
                    const catGroups = [ { items: ["Apfel", "Banane", "Birne"], odd: "M√∂hre" }, { items: ["Auto", "Bus", "LKW"], odd: "Fahrrad" }, { items: ["Hammer", "Zange", "Bohrer"], odd: "Nagel" }, { items: ["Hemd", "Hose", "Pullover"], odd: "Schrank" } ];
                    const cG = catGroups[Math.floor(Math.random() * catGroups.length)]; qText = "Welcher Begriff passt logisch am wenigsten zu den anderen drei?";
                    options = [...cG.items.slice(0,3), cG.odd].sort(() => 0.5 - Math.random()); currentAnswer = cG.odd; break;
            }

            document.getElementById('round-counter').innerText = mode === 'sprint' ? `Frage: ${currentRound} / 30` : `Frage: ${currentRound} (Endlos)`;
            document.getElementById('question-text').innerText = qText;
            const dataEl = document.getElementById('data-display'); if (dataText !== "") { dataEl.style.display = 'block'; dataEl.innerText = dataText; } else { dataEl.style.display = 'none'; }
            const grid = document.getElementById('options-grid'); grid.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button'); btn.className = 'option-btn'; btn.innerText = opt; btn.onclick = () => handleAnswer(opt, type); grid.appendChild(btn);
            });

            timeLeft = timeLimit; document.getElementById('timer-bar').style.width = '100%'; questionStartTime = Date.now();
            clearInterval(testTimerInterval); testTimerInterval = setInterval(() => updateTestTimer(type), 50);
        }

        function updateTestTimer(type) {
            timeLeft -= 0.05;
            document.getElementById('timer-bar').style.width = (timeLeft / timeLimit) * 100 + '%';
            document.getElementById('timer-text').innerText = Math.max(0, timeLeft).toFixed(1) + "s";
            if (timeLeft <= 4) document.getElementById('timer-bar').style.backgroundColor = '#C0392B'; else document.getElementById('timer-bar').style.backgroundColor = 'var(--accent)';
            if (timeLeft <= 0) {
                clearInterval(testTimerInterval); analytics[type].attempts++; analytics[type].time += timeLimit; 
                currentRound++; generateQuestion(); 
            }
        }

        function handleAnswer(selected, type) {
            clearInterval(testTimerInterval); const timeTaken = (Date.now() - questionStartTime) / 1000;
            analytics[type].attempts++; analytics[type].time += timeTaken;
            if (selected === currentAnswer) {
                analytics[type].correct++;
                if (isHardcore && mode === 'sprint' && timeLimit > 5.0) timeLimit -= 0.5; // HARDCORE LOGIK
            }
            currentRound++; generateQuestion();
        }

        function endTest() {
            clearInterval(testTimerInterval); clearInterval(globalTimerInterval); showScreen('result-area');
            document.getElementById('result-title').innerText = mode === 'sprint' ? "Sprint Abgeschlossen" : "Marathon √úberlebt";
            let totalAttempts = 0; let totalCorrect = 0; let totalTime = 0; const tbody = document.getElementById('analytics-body'); tbody.innerHTML = '';
            for(let i=0; i<16; i++) {
                let stat = analytics[i];
                if(stat.attempts > 0) {
                    totalAttempts += stat.attempts; totalCorrect += stat.correct; totalTime += stat.time;
                    let acc = Math.round((stat.correct / stat.attempts) * 100); let avgT = (stat.time / stat.attempts).toFixed(1);
                    let tr = document.createElement('tr');
                    if(acc < 70 || avgT > 8.0) tr.className = 'weakness'; else if(acc === 100 && avgT < 5.0) tr.className = 'strength';
                    tr.innerHTML = `<td style="text-align:left;">${typeNames[i]}</td><td>${stat.attempts}</td><td>${acc}%</td><td>${avgT}s</td>`;
                    tbody.appendChild(tr);
                }
            }
            const overallAcc = totalAttempts > 0 ? Math.round((totalCorrect / totalAttempts) * 100) : 0; const overallAvg = totalAttempts > 0 ? (totalTime / totalAttempts).toFixed(2) : 0;
            const scoreCircle = document.getElementById('score-display'); scoreCircle.innerText = `${overallAcc}%`;
            scoreCircle.style.background = overallAcc >= 80 ? 'var(--success)' : 'var(--accent)';
            document.getElementById('stats-display').innerHTML = `Absolvierte Aufgaben: <strong>${totalAttempts}</strong><br>Richtige Antworten: <strong>${totalCorrect}</strong><br>Durchschnittszeit: <strong>${overallAvg} Sekunden / Frage</strong><br>`;
        }
    </script>
</body>
</html>
